<!DOCTYPE html>
<html>

<head>
	<meta charset='utf-8'>
	<title>Cargo-specification</title>
	<script src='https://www.w3.org/Tools/respec/respec-w3c' class='remove'></script>
	<script class='remove'>
		async function loadRust() {
			//this is the function you call in 'preProcess', to load the highlighter
			const worker = await new Promise(resolve => {
				require(["core/worker"], ({ worker }) => resolve(worker));
			});
			const action = "highlight-load-lang";
			const langURL =
				"https://gistcdn.githack.com/mimoo/a9e28fc565dddb369477e8bd34e6a1ae/raw/d8a7057fe9c7140f7ef5972b333716d9933fa29b/hljs-rust.js";
			const propName = "hljsDefineRust"; // This funtion is defined in the highlighter being loaded
			const lang = "rust"; // this is the class you use to identify the language
			worker.postMessage({ action, langURL, propName, lang });
			return new Promise(resolve => {
				worker.addEventListener("message", function listener({ data }) {
					const { action: responseAction, lang: responseLang } = data;
					if (responseAction === action && responseLang === lang) {
						worker.removeEventListener("message", listener);
						resolve();
					}
				});
			});
		}


		async function loadProto() {
			//this is the function you call in 'preProcess', to load the highlighter
			const worker = await new Promise(resolve => {
				require(["core/worker"], ({ worker }) => resolve(worker));
			});
			const action = "highlight-load-lang";
			const langURL =
				"https://gistcdn.githack.com/mimoo/a9e28fc565dddb369477e8bd34e6a1ae/raw/555beea7387129c657c49d8616b778c67629b586/hljs-proto.js";
			const propName = "hljsDefineProto"; // This funtion is defined in the highlighter being loaded
			const lang = "proto"; // this is the class you use to identify the language
			worker.postMessage({ action, langURL, propName, lang });
			return new Promise(resolve => {
				worker.addEventListener("message", function listener({ data }) {
					const { action: responseAction, lang: responseLang } = data;
					if (responseAction === action && responseLang === lang) {
						worker.removeEventListener("message", listener);
						resolve();
					}
				});
			});
		}

		var respecConfig = {
			preProcess: [loadRust, loadProto],
			specStatus: "base",
			editors: [
				// 
				{
					name: "David Wong",
					url: "",
				},
				// 
			],
			github: "",
			shortName: "",
			//			format: "markdown",
		};
	</script>
</head>

<body>
	<section id="abstract">This specification describes how the command-line utility cargo-specification works.</section>

	<h2>Cargo-specification</h2>
<p>The main algorithm:</p>
<ol>
<li>
<p>parse command-line arguments</p>
</li>
<li>
<p>parse the Specification.toml file</p>
</li>
<li>
<p>retrieves the content from all the files listed in the .toml</p>
</li>
<li>
<p>figures out the spec format</p>
</li>
</ol>
<h2>File parser</h2>
<ul>
<li>for markdown files, we retrieve the entire content</li>
</ul>
<h2>TOML Parser</h2>
<p>A specification is all the concatenated comments from a list of files
The list of files is maintained by a Specification.toml file.</p>
<p>Below are the different structures that we use to organize the specification:</p>
<pre lang="rust"><code>
/// A specification file contains a specification, as well as sections of (title, text)
#[derive(Deserialize, Debug)]
pub struct Specification {
    /// information about a specification
    pub metadata: Metadata,
    /// vec of files
    pub sections: BTreeMap&lt;String, Vec&lt;String&gt;&gt;,
}

/// Metadata about a specification
#[derive(Deserialize, Debug)]
pub struct Metadata {
    /// Name of the specification
    pub name: String,
    /// A description
    pub description: String,
    /// Version of the spec
    pub version: Option&lt;String&gt;,
    /// Authors, if any
    pub authors: Vec&lt;String&gt;,
}

</code></pre>


</body>

</html>